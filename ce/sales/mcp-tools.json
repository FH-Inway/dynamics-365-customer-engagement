"x-ms-modelContextProtocol": {
    "servers": [
      {
        "serverId": "SalesMCPServer",
        "displayName": "D365 Sales MCP Server",
        "summary": "D365 Sales MCP Server",
        "description": "MCP server for Sales scenario which helps with Lead Qualification, Outreach Email Drafting and Sending Email to Customer.",
        "tags": [ "agentic" ],
        "tools": [
          {
            "name": "D365_Sales_ListLeads",
            "description": "Use this tool to retrieve a list of sales leads for the organization or to search for specific leads by their attributes (such as name, status, owner, topic, or quality code). This is typically the first step in any lead management workflow, allowing you to identify and select leads for further actions.",
            "x-ms-route": "/api/data/v9.1.0/leads",
            "x-ms-verb": "GET",
            "inputSchema": {
              "type": "object",
              "properties": {
                "$top": {
                  "type": "integer",
                  "description": "Specify the maximum number of lead records to return in the result set. Use this to limit the number of leads retrieved in a single request.",
                  "x-ms-location": "query",
                  "x-ms-path": "$top"
                },
                "$filter": {
                  "type": "string",
                  "description": "Provide an OData filter expression to narrow down the list of leads based on specific criteria, such as lead quality, status, owner, topic, or partial matches on fields like fullname. Example: 'leadqualitycode eq 1' for Hot leads or 'contains(fullname, 'John')' for leads with 'John' in the name.",
                  "x-ms-location": "query",
                  "x-ms-path": "$filter"
                }
              },
              "required": [
              ]
            }
          },
          {
            "name": "D365_Sales_QualifyLeadToOpportunity",
            "description": "Use this tool to qualify a selected lead and convert it into an opportunity. This action is performed after reviewing and selecting a lead, and it marks the lead as qualified, optionally creating related account, contact, or opportunity records as part of the sales process.",
            "x-ms-route": "/api/data/v9.1.0/leads({leadid})/Microsoft.Dynamics.CRM.QualifyLead",
            "x-ms-verb": "POST",
            "inputSchema": {
              "type": "object",
              "properties": {
                "leadid": {
                  "type": "string",
                  "description": "The unique identifier (ID) of the lead to be qualified. This value is required to specify which lead should be converted into an opportunity.",
                  "x-ms-location": "path",
                  "x-ms-path": "leadid"
                },
                "CreateAccount": {
                  "type": "boolean",
                  "description": "Set to true if a new account should be created during lead qualification. Set to false to skip account creation. This parameter is required.",
                  "x-ms-location": "body",
                  "x-ms-path": "CreateAccount",
                  "x-ms-default": "false"
                },
                "CreateContact": {
                  "type": "boolean",
                  "description": "Set to true if a new contact should be created during lead qualification. Set to false to skip contact creation. This parameter is required.",
                  "x-ms-location": "body",
                  "x-ms-path": "CreateContact",
                  "x-ms-default": "false"
                },
                "CreateOpportunity": {
                  "type": "boolean",
                  "description": "Set to true to create an opportunity record as part of the lead qualification process. This parameter is required and typically set to true.",
                  "x-ms-location": "body",
                  "x-ms-path": "CreateOpportunity",
                  "x-ms-default": "true"
                },
                "Status": {
                  "type": "integer",
                  "description": "The status code to assign to the lead after qualification. For example, set to 3 to indicate the lead is qualified. This parameter is required.",
                  "x-ms-location": "body",
                  "x-ms-path": "Status",
                  "x-ms-default": "3"
                }
              },
              "required": [
                "leadid"
              ]
            }
          },
          {
            "name": "D365_Sales_InvokeLeadSummary",
            "description": "Use this tool to generate a detailed summary of a specific lead by providing its lead ID. This is helpful for quickly understanding the background, status, and key information about a lead before taking further actions such as qualification or outreach.",
            "x-ms-route": "/flow/api/data/v9.1.0/msdyn_SalesLeadSummary",
            "x-ms-verb": "POST",
            "inputSchema": {
              "type": "object",
              "properties": {
                "msdyn_id": {
                  "type": "string",
                  "description": "The unique identifier (leadid) of the lead for which you want to generate a summary. This value is required to retrieve the summary information.",
                  "x-ms-location": "body",
                  "x-ms-path": "msdyn_id"
                }
              },
              "required": [
                "msdyn_id"
              ]
            }
          },
          {
            "name": "D365_Sales_DraftOutreachEmail",
            "description": "Use this tool to automatically draft a personalized outreach email for a specific lead based on their lead ID. This is typically used after identifying a lead and before sending an email, to ensure the communication is relevant and tailored.",
            "x-ms-route": "/flow/api/data/v9.2.0/msdyn_GetLeadEngagementEmailDraft",
            "x-ms-verb": "POST",
            "inputSchema": {
              "type": "object",
              "properties": {
                "LeadId": {
                  "type": "string",
                  "description": "The unique identifier (leadid) of the lead for which the outreach email draft should be generated. This value is required.",
                  "x-ms-location": "body",
                  "x-ms-path": "LeadId"
                }
              },
              "required": [
                "LeadId"
              ]
            }
          },
          {
            "name": "D365_Sales_SendOutreachEmail",
            "description": "Use this tool to send an outreach email to a customer using a previously drafted email for a specific lead. This is the final step in the outreach process, where the email is sent to the customer's email address, and the communication is logged against the lead.",
            "x-ms-route": "/api/data/v9.2.0.0/CreateAndSendNewEmail",
            "x-ms-verb": "POST",
            "inputSchema": {
              "type": "object",
              "properties": {
                "Subject": {
                  "type": "string",
                  "x-ms-location": "body",
                  "description": "The subject line of the outreach email to be sent to the customer. This value is required.",
                  "x-ms-path": "Subject"
                },
                "Body": {
                  "type": "string",
                  "x-ms-location": "body",
                  "description": "The main content or body of the outreach email. This value is required.",
                  "x-ms-path": "Body"
                },
                "To": {
                  "type": "string",
                  "description": "The recipient's email address. This should be the email address of the customer associated with the lead. This value is required.",
                  "x-ms-location": "body",
                  "x-ms-path": "To"
                },
                "leadid": {
                  "type": "string",
                  "description": "The unique identifier (leadid) of the lead for which the outreach email is being sent. This value is required to associate the email with the correct lead.",
                  "x-ms-location": "body",
                  "x-ms-path": "Regarding.leadid",
                  "x-ms-keyname": "leadid"
                },
                "odata_type": {
                  "type": "string",
                  "x-ms-location": "body",
                  "description": "The data type of the lead record. This must always be set to 'Microsoft.Dynamics.CRM.lead' to ensure correct association with the lead entity.",
                  "x-ms-default": "Microsoft.Dynamics.CRM.lead",
                  "x-ms-path": "Regarding.odata_type",
                  "x-ms-keyname": "@odata.type"
                }
              },
              "required": [
                "Subject",
                "Body",
                "To",
                "leadid"
              ]
            }
          }
        ]
      },